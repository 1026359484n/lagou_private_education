##### 1. 业务管理类系统的技术选型应该注意哪些？有现成的脚手架项目可参考吗？

注意细节：脚手架选用以团成员都熟悉的框架为基础搭建的为好
相关项目：
https://github.com/yangzongzhuan/RuoYi
http://www.ruoyi.vip/

##### 2. k8s中部署springcloud，最外层是Ingress nginx。里面使用gateway做网关，通过服务名调用。现在遇到的问题是每次服务重启会无法访问，需要重启gateway才能访问到。我的理解是ingress nginx应该只是代理指向到gateway实例，然后由 gateway再次路由。gateway是通过eureka获取的服务信息，动态转发请求，为什么会出现这种情况啊

如何排查：
查看gateWay缓存是不是没有刷新，可以通过服务日志查看一下可能原因：可能eureka三级缓存机制导致，存在一定的延时可以通过配置缩短缓存时间，或者关闭缓存gateway缓存。
解决思路:
按照群里讨论的思路，去看了gateway和eureka的缓存。我们现在eureka是多实例部署,在服务实例的时候，服务被部署到新的机器，被分配新的地址，但是euraka有的实例还是之前的状态，有的实例的信息显示没有这个服务。导致gateway拉取到的服务连接不对。报timeout异常，找不到对应服务。等待一段时间后就恢复正常了。
缩短服务实例客户端上报周期间隔和eureka实例从其他eureka拉取配置信息的周期。

##### 4. 面试时曾被问个过的问题，创建一个联合索引，字段分别为a、b、c，如何在查询条件为b、c时使索引生效

正常情况是不符合最左前缀原则的，是不可能在不新增索引的情况下，使用条件 b、c 索引生效的。
注:: 可以创建 bc. 或 b 或c 索引。 具体操作要看数据选择性，选择性高的优先创建。 另外， 也要看查询方式。 范围查询的字段放在后面。

##### 5. 请问应该如何给下属合理安排任务，我们现在有很多任务，我期望尽量将任务进度向前赶，因为越往后风险越高，可能与后续任务抢占资源，但是如何评估一个开发人员完成多少任务是符合其能力的呢，比如同样是5个接口， 有的人需要加班到10点，有的人下班前就完成了，那还应不应该给做的快的人增加任务呢。如果不增加，每天都不加班，但是来了新的任务又说饱和了，接不了。如果增加，那谁还会提高效率呢

1、组内梯队建设、不同梯队分配相应难度的任务
2、任务分优先级
3、要优先做对自己团队有收益的需求、没收益的可以拒绝。
4、通过绩效激励优秀的同事多做事
注:: 本身团队要建立良性竞争

##### 7. 在分库分表的情况下，对于需要查询多个表的情况，一般都是先查询主表，然后根据主表的id去查询其他表的数据。但有时候主表和其他表都有查询条件，而且还需要进行分页，此时如果不使用多表联查的话，还有什么其他更好的解决方式么？

分库分表策略：相互关联的表使用相同的分库分表策略，分到同一节点避免跨库
通用做法: 通过binlog加工数据到其他存储（ES、ck、hive等）
通用技术: ETL(数据库仓储)/databus (数据库同步系统)
方案1：比如说监听主表binlog，把你要的从表的字段读出来，再新建一张宽表。然后存到ES或者其他大数据引擎。
方案2：通过canal等工具解析binlog将数据复制到es这些搜索效率更高的工具中。

##### 8. 需要设计一个抢单的功能，需要如何设计才能更优雅平滑的应对高并发下带来的问题。我想过用分布式锁或者乐观锁实现，但是感觉还是有点迷茫。虽然这个功能暂时真实并发不会太高，但是想尽量设计得能抗能打一点。

核心点: 是一个多对多问题，一边创建订单，一边消费订单
解决方案：
方案1：多对多的话考虑一个单一个锁一把钥匙，抢完既消毁缺点。创建太多锁占用太多资源边界点。要考虑锁超时，锁续租的问题 （设置自动失效时间）

##### 9. 最近在看MySQL事务这块，发现MySQL事务并不能解决高并发情况余额扣减为负数或秒杀超卖的问题（除了串行化，但效率太低），像在实际的高并发场景中，余额的扣减或是库存的扣减通常用那些方案比较可靠又性能好一些。

##### 事务A:

```
update account set amount = amount - 80 where id = 10;
```

##### 事务B:

```
update account set amount = amount - 80 where id = 10;
```

两个事务都执行同样的扣减，然后就余额为负数了
针对题目情况可以将扣减金额做为 where 条件使用如下代码解决：

```
update account set amount = amount - 80 where id = 10 and amount>80;
```

通用情况，可以通过乐观锁和悲观锁以及redis:
悲观锁：for update
乐观锁：版本号时间戳
redis：通过redis 实现分布式锁，进行加减库存

##### 10. 我们的项目网管是是用Gateway，然后我就在Gateway里验签，但是一直验签失败，我排查问题发现别人的等签名字符串和我收到的参数不一样。

##### {"userId":"1","userName":"杨红利","age":25}

##### 别人是这样去签名的，然后我收到的请求体就成了

##### {"age":25,"userId":"1","userName":"杨红利"}

建议： 传输前后分别对字段排序，约定优于配置

##### 11、在做订单号生成的时候，想有一定的规律，代表时间 、品类、业务线，又不想是自增，容易被猜出规律，但是增加随机数字，又怕生成相同的随机数导致订单号重复，一开始用的是在数据库预先生成一堆随机数，每次用的时候随机取。但是这样效率太低，后来改了一下实现，就是先生成，然后直接插入，如果异常再重新生成。想知道有什么好的设计实现。

解题思路：
1、部分自增+随机位混淆生成
2、核销环节增加校验，通过用户身份识别，例如登陆账号之类可以确定用户
3、身份的数据进行关联校验，防止被猜到数据生成方式比如：短信验证等
雪花算法